<!-- parking/templates/car_list.html -->
{% extends "parking/base.html" %} {% block content %} {% load static %}
<h3 class="mb-3 mt-3">List of Cars</h3>

<!-- Форма фільтрації -->
<form method="GET" action="{% url 'cars:car_list' %}">
  <!-- {% csrf_token %} -->
  <!-- Додайте поля фільтрації за вашими потребами -->
  <div class="container">  
    <div class="row">  
        <div class="col">  
          <div class="input-group mb-2">
            <label class="input-group-text" for="car_number">Car Number:</label>
            <input type="text" class="form-control" name="car_number" style="width: 300px" />
          </div>
        </div>
        <div class="col-md-3">
          <div class="input-group mb-2">
            <label class="input-group-text" for="blocked">Blocked:</label>
            <select class="form-select" name="blocked">
              <option value="" {% if request.GET.blocked == "" %}selected{% endif %}>Any</option>
              <option value="True" {% if request.GET.blocked == "True" %}selected{% endif %}>Yes</option>
              <option value="False" {% if request.GET.blocked == "False" %}selected{% endif %}>No</option>
            </select>
          </div>
        </div>
        <div class="col-md-3">
          <div class="input-group mb-2">
            <label class="input-group-text" for="blocked">PayPass:</label>
            <select class="form-select" name="paypass">
              <option value="" {% if request.GET.paypass == "" %}selected{% endif %}>Any</option>
              <option value="True" {% if request.GET.paypass == "True" %}selected{% endif %}>Yes</option>
              <option value="False" {% if request.GET.paypass == "False" %}selected{% endif %}>No</option>
            </select>
          </div>
        </div>
        <div class="col-md-1">  
          <button class="btn btn-primary mb-3" type="submit" style="width: 100%">Filter</button>
        </div>
    </div>
  </div>


</form>

{% if cars %}
<div class="bd-example">
  <form method="post" action="{% url 'cars:car_list' %}">
    {% csrf_token %}
    <table class="table table-striped table-hover">
      <thead>
        <tr>
          <th scope="col">Number</th>
          <!-- <th scope="col">Photo</th>
        <th scope="col">Predict</th> -->
          <th scope="col" class="text-center">Blocked</th>
          <th scope="col" class="text-center">Pay Pass</th>
        </tr>
      </thead>
      <tbody>
        {% for car in page_obj %}
        <input type="hidden" name="cars" value="{{car.pk}}" />
        <tr>
          <th scope="row">{{ car.car_number }}</th>
          <!-- <td>
              <img src="{{ car.photo_car.url }}" alt="Car photo">
        </td> -->
          <!-- <td>{{ car.predict }}</td> -->
          <td class="text-center">
            <input
              type="checkbox"
              data-id="{{ car.pk }}"
              name="blocked"
              value="{{ car.pk }}"
              {% if car.blocked %}
              checked
              {% endif %}
            />
          </td>
          <td class="text-center">
            <input
              type="checkbox"
              data-id="{{ car.pk }}"
              name="pay_pass"
              value="{{ car.pk }}"
              {% if car.PayPass %}
              checked
              {% endif %}
            />
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
    <nav>
      <div class="d-flex justify-content-center">
        <span class="text-center" style="width: 80px">
          {% if page_obj.has_previous %}
          <a href="?page={{ page_obj.previous_page_number }}&blocked={{request.GET.blocked}}&paypass={{request.GET.paypass}}" class="btn btn-sm btn-outline-primary" role="button">Prev</a>
          {% endif %}
        </span>
    
        <ul class="pagination pagination-sm">
          {% for p in paginator.page_range %}
          <li class="page-item{% if p == page_obj.number %} active{% endif %}">
            <a href="?page={{ p }}&blocked={{request.GET.blocked}}&paypass={{request.GET.paypass}}" class="page-link">{{ p }}</a>
          </li>
          {% endfor %}
        </ul>
        <span class="text-center" style="width: 80px">
          {% if page_obj.has_next %}
          <a href="?page={{ page_obj.next_page_number }}&blocked={{request.GET.blocked}}&paypass={{request.GET.paypass}}" class="btn btn-sm btn-outline-primary" role="button">Next</a>
          {% endif %}
        </span>
      </div>
    </nav>
    <button class="btn btn-primary mb-3" type="submit">Save</button>
  </form>
{% else %}
<li>No cars found.</li>
{% endif %}
<br />

{% endblock content %}
